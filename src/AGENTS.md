# AGENTS.md

<!-- generated by agents-md-generator | last_generated: 2026-02-12 -->

> AI Agent Guide — Entry point for AI coding agents working in this project.

## Project Overview

| Aspect | Value |
|--------|-------|
| **Stack** | Ruby on Rails 8.1, Ruby 3.4, SQLite3, Vite, Tailwind CSS, Stimulus, Turbo |
| **Architecture** | Rails MVC with Service Objects pattern |
| **Source Root** | `src/` (this directory) |

## Global Rules

### Naming Conventions

| Element | Pattern | Example |
|---------|---------|---------|
| Ruby files | `snake_case.rb` | `exam_session.rb`, `exams_controller.rb` |
| Ruby classes | `PascalCase` | `ExamSession`, `ExamsController` |
| Methods/variables | `snake_case` | `current_user`, `find_or_create_attempt` |
| Stimulus controllers | `snake_case_controller.js` | `exam_controller.js`, `room_countdown_controller.js` |
| Views | `{action}.html.erb` in `views/{controller}/` | `views/exams/index.html.erb` |
| Tests | `{name}_test.rb` | `exams_controller_test.rb` |

### Coding Style

- Add `# frozen_string_literal: true` as first line of every Ruby file
- Follow `rubocop-rails-omakase` style — run `bin/rubocop` before commit
- Keep controllers thin — move business logic to models or services
- Use strong parameters in controllers (`params.require(:model).permit(...)`)
- Use scopes for reusable query patterns in models
- Handle `nil` returns from `find_by` — add explicit error handling
- Use `transaction do` for operations that must be atomic

### Import Rules

- Controllers may use models, services, helpers
- Models should not depend on controllers or views
- Services may use models but not controllers
- Stimulus controllers are standalone — no cross-controller imports
- Helpers are view-only utilities

## Module Map

| Directory | Purpose | Complexity |
|-----------|---------|------------|
| `app/controllers/` | HTTP request handling, auth, redirects | complex |
| `app/models/` | ActiveRecord models, validations, associations | complex |
| `app/services/` | Business logic encapsulated in service objects | moderate |
| `app/views/` | ERB templates organized by controller | moderate |
| `app/frontend/` | Stimulus JS controllers for UI interactivity | moderate |
| `app/helpers/` | View helper methods | simple |
| `app/jobs/` | Background job classes | simple |
| `app/mailers/` | Email mailer classes | simple |
| `app/channels/` | Action Cable channels | simple |
| `test/` | Minitest tests (controllers, models, fixtures) | moderate |
| `config/` | Rails configuration files | simple |
| `db/` | Migrations, schema, seeds | moderate |

## Decision Tree

When you receive a task, determine which module(s) are involved and read their AGENTS.md:

| Task Type | Read |
|-----------|------|
| Add/modify API endpoint or page | `app/controllers/AGENTS.md` |
| Add/modify data model or validation | `app/models/AGENTS.md` |
| Add/modify business logic | `app/services/AGENTS.md` |
| Add/modify UI template | `app/views/AGENTS.md` |
| Add/modify JS interactivity | `app/frontend/AGENTS.md` |
| Add/modify tests | `test/AGENTS.md` |
| Add/modify database schema | `db/AGENTS.md` |

## Before Any Task

1. Read this file (you are doing it now)
2. Identify which module(s) your task touches
3. Read the AGENTS.md in each relevant module directory
4. Follow both global rules (this file) AND module-specific rules

## Common Pitfalls

| ❌ Don't | ✅ Do |
|----------|-------|
| Put business logic in controllers | Extract to service objects or model methods |
| Use raw SQL with string interpolation | Use parameterized queries or `where(col: val)` |
| Skip `frozen_string_literal` pragma | Add `# frozen_string_literal: true` as first line |
| Call `find_by` without nil handling | Check for `nil` or use `find_by!` |
| Hardcode secrets in source | Use Rails credentials or ENV variables |
| Skip strong parameters | Always use `params.require().permit()` |
