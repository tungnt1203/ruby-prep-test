<div class="min-h-screen bg-slate-50 flex items-center justify-center p-4">
  <div class="w-full max-w-md rounded-xl bg-white shadow-sm ring-1 ring-slate-200 p-8">
    <h1 class="text-xl font-semibold text-slate-900">Schedule a Ruby interview room</h1>
    <p class="mt-2 text-sm text-slate-600">Create a timed room so candidates can join and start the Ruby test at the same time.</p>

    <%= form_with url: rooms_path, method: :post, local: true, data: { turbo: false }, class: "mt-6 space-y-4" do |f| %>
      <div>
        <label for="exam_hash_id" class="block text-sm font-medium text-slate-700">Exam</label>
        <% if @exam_sessions.any? %>
          <select name="exam_hash_id" id="exam_hash_id" class="mt-1 block w-full rounded-lg border border-slate-300 px-3 py-2 text-slate-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" onchange="var w=document.getElementById('exam_hash_manual_wrapper'); w.classList.toggle('hidden', this.value!=='__manual__'); if(this.value!=='__manual__') document.getElementById('exam_hash_id_manual').value='';">
            <option value="">-- Select exam --</option>
            <% @exam_sessions.each do |es| %>
              <option value="<%= es.hash_id %>"><%= es.exam_title %> (<%= es.hash_id %>, <%= es.total_questions %> questions)</option>
            <% end %>
            <option value="__manual__">── Enter code manually ──</option>
          </select>
          <div id="exam_hash_manual_wrapper" class="mt-2 hidden">
            <input type="text" name="exam_hash_id_manual" id="exam_hash_id_manual" placeholder="Paste exam code" class="block w-full rounded-lg border border-slate-300 px-3 py-2 text-slate-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" />
          </div>
        <% else %>
          <input type="text" name="exam_hash_id" id="exam_hash_id" required placeholder="e.g. abc123def456" class="mt-1 block w-full rounded-lg border border-slate-300 px-3 py-2 text-slate-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" />
          <p class="mt-1 text-xs text-amber-600">No exams yet. <%= link_to "Create an exam first", pre_exams_path, class: "underline" %>, then come back.</p>
        <% end %>
      </div>
      <div>
        <label for="room_name" class="block text-sm font-medium text-slate-700">Room name (optional)</label>
        <input type="text" name="room_name" id="room_name" placeholder="e.g. Ruby Backend – <%= Date.current.strftime('%Y-%m-%d') %>" class="mt-1 block w-full rounded-lg border border-slate-300 px-3 py-2 text-slate-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" />
      </div>
      <div>
        <label for="instructions" class="block text-sm font-medium text-slate-700">Instructions for candidates (optional)</label>
        <textarea name="instructions" id="instructions" rows="3" placeholder="e.g. Cameras on. No external help." class="mt-1 block w-full rounded-lg border border-slate-300 px-3 py-2 text-slate-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"></textarea>
      </div>
      <div class="flex flex-col gap-2">
        <label class="flex items-center gap-2">
          <input type="hidden" name="require_display_name" value="0" />
          <input type="checkbox" name="require_display_name" id="require_display_name" value="1" checked class="rounded border-slate-300 text-indigo-600 focus:ring-indigo-500" />
          <span class="text-sm text-slate-700">Require display name to start</span>
        </label>
        <label class="flex items-center gap-2">
          <input type="hidden" name="require_candidate_identifier" value="0" />
          <input type="checkbox" name="require_candidate_identifier" id="require_candidate_identifier" value="1" class="rounded border-slate-300 text-indigo-600 focus:ring-indigo-500" />
          <span class="text-sm text-slate-700">Require email / candidate ID to start</span>
        </label>
      </div>
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label for="starts_at_date" class="block text-sm font-medium text-slate-700">Start date</label>
          <input type="date" name="starts_at_date" id="starts_at_date" required class="mt-1 block w-full rounded-lg border border-slate-300 px-3 py-2 text-slate-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" />
        </div>
        <div>
          <label for="starts_at_time" class="block text-sm font-medium text-slate-700">Start time</label>
          <input type="time" name="starts_at_time" id="starts_at_time" required class="mt-1 block w-full rounded-lg border border-slate-300 px-3 py-2 text-slate-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" />
        </div>
      </div>
      <div>
        <label for="duration_minutes" class="block text-sm font-medium text-slate-700">Time limit (minutes, optional)</label>
        <input type="number" name="duration_minutes" id="duration_minutes" min="0" placeholder="e.g. 45 (blank = no limit)" class="mt-1 block w-full rounded-lg border border-slate-300 px-3 py-2 text-slate-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" />
      </div>
      <button type="submit" class="w-full rounded-lg bg-indigo-600 px-4 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
        Create room
      </button>
    <% end %>

    <p class="mt-4 text-xs text-slate-500">
      <%= link_to "← Back", root_path, class: "text-indigo-600 hover:underline" %>
    </p>
  </div>
</div>
